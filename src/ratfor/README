This directory contains ratfor source for the several routines of the
rq library.  These are not strictly necessary, but they may prove useful
to anyone wanting to look at the source in detail, since the fortran
translation of them by the ratfor compiler is far from readable.

Note added September 17, 2004

Apparently g77 v3.4 doesn't like double precision data statements so
these have been changed to parameter() declarations.  This turned out
to be a bug in g77, but the deed is done so I've left the parameter
statements in place of the original data statements.  However, this
entailed the dangerous step of installing the SEP ratfor77 translator.
(See http://sepwww.stanford.edu/software/ratfor.html for details.)

Past experience, and now a bug file in the SEP distro, suggests
that the ratfor switch statement is unlikely to be correctly handled.
Fortunately, none of the included routines in the directory use switch
but caution is undoubtedly indicated.  The fortran produced for rqbr.r
is somewhat different than that produced by my older sun version, and
generates two warnings from g77, but these appear to be harmless.

Note added March 16, 2005

g77 has been issuing warnings for the code generated from the
SEP distro of ratfor version of rqbr.r for a while now, but
yesterday Jan deLeeuw reported that it now generates an error
in his gfortran 4.0 on osx.  After some comparisons with old
version of the ratfor translation, in particular the rq.f in
rq/statlib.95 on ysidro, I determined that what the compiler
didn't like was the way that if-endifs were generated by
the SEP translation.  So.... I hand edited these last few
if-endifs in the .f file, and move that back into the src
directory. This is TOTALLY unsatisfactory, since it means
that this needs to be done yet again if any changes are
made to the ratfor code, but seems to be the cost of  using
the SEP translator.  A more clever guy with more time could
probably find a way to change the ratfor, but given other
constraints that ain't going to happen anytime soon.  Note
that I've for future reference put a version of the old rq.f
file generated by my old BTL ratfor translator into this
directory. as well as the new rqbr.f. 

Note added Oct 22, 2007

As part of the development of the crqfnb function I downloaded
the SEP version of ratfor77, which seems to work ok on this 
function.  It is installed in my $HOME/bin directory and the
build is in the Rinstall directory.  Note that now on yzzy
ratfor is called ratfor77.

Note added May 14, 2016

Contrary to the last note, it appears that my $HOME/bin/ratfor
command works and $HOME/bin/ratfor77 does not.

Note added Jan 22, 2020

Contrary to the last note there is no $HOME/bin/ratfor* but I've installed
ratfor90 in /usr/local/bin and this might produce something workable.  Not
yet really tested seriously, but those ugly line numbers are gone, at least.

Note added November 8 2020

I've installed a new ratfor executable in my mac mini bin directory.  It
is generated from Brian Gaeke's C distribution ratfor-1.05.  And seems to work
well; i.e. produces .f files that compile with gfortran -c with only a couple
of warnings about legacy syntax.  The good news is that these warnings are 
emitted only for the rqbr.f code produced from rqbr.r, for which my handedited
rqbr.f version still passes R CMD check.  This was reported to Brian and he
suggested flags that could be used to quell the emissions, but this didn't
seem a.) very practical, or b.) very necessary.  I've put links to Brian G's
code for ratfor and to Brian K's BTL memo describing ratfor on my
reproducibility webpage.  So for the foreseeable, we are ok on the ratfor
front, including for the new subroutines pfnb.r and qfnb.r.
